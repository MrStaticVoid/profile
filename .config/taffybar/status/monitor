#!/usr/bin/env ruby

require 'concurrent'
require 'status'

widgets = [
  LoadStatus.new,
  PowerStatus.new,
  NetworkStatus.new,
  AudioStatus.new,
  BacklightStatus.new,
  ScreensaverStatus.new,
  VpnStatus.new,
]

at_exit { widgets.each(&:cleanup) }
threads = widgets.map { |widget| Thread.new { widget.monitor } }
threads.each(&:join)
